<script src="{{ base_path }}/assets/js/main.min.js"></script>

{% include analytics.html %}
{% include /comments-providers/scripts.html %}

<script>
(function() {
  /* ==========================================
     Masthead transparent → frosted on scroll
     ========================================== */
  var masthead = document.querySelector('.masthead');
  if (masthead) {
    var onScroll = function() {
      if (window.scrollY > 50) {
        masthead.classList.add('masthead--scrolled');
      } else {
        masthead.classList.remove('masthead--scrolled');
      }
    };
    window.addEventListener('scroll', onScroll, { passive: true });
    onScroll();
  }

  /* ==========================================
     Scroll Reveal — Intersection Observer
     ========================================== */
  var reveals = document.querySelectorAll('.scroll-reveal');
  if (reveals.length && 'IntersectionObserver' in window) {
    var observer = new IntersectionObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          entry.target.classList.add('scroll-reveal--visible');
          observer.unobserve(entry.target);
        }
      });
    }, { threshold: 0.1, rootMargin: '0px 0px -40px 0px' });

    reveals.forEach(function(el) {
      observer.observe(el);
    });
  } else {
    // Fallback: show everything
    reveals.forEach(function(el) {
      el.classList.add('scroll-reveal--visible');
    });
  }

  /* ==========================================
     Typewriter Effect
     ========================================== */
  var typewriterEl = document.getElementById('typewriter-text');
  if (typewriterEl) {
    var phrases = [
      'Research Data Scientist, Cedars-Sinai Medical Center',
      'Deep Learning for Biomedical Data',
      'LLMs & Knowledge Graph Reasoning',
      'Bridging AI and Clinical Science'
    ];
    var phraseIndex = 0;
    var charIndex = 0;
    var isDeleting = false;
    var typeSpeed = 60;
    var deleteSpeed = 35;
    var pauseEnd = 2000;
    var pauseStart = 500;

    function typewrite() {
      var current = phrases[phraseIndex];
      if (!isDeleting) {
        typewriterEl.textContent = current.substring(0, charIndex + 1);
        charIndex++;
        if (charIndex === current.length) {
          isDeleting = true;
          setTimeout(typewrite, pauseEnd);
          return;
        }
        setTimeout(typewrite, typeSpeed);
      } else {
        typewriterEl.textContent = current.substring(0, charIndex - 1);
        charIndex--;
        if (charIndex === 0) {
          isDeleting = false;
          phraseIndex = (phraseIndex + 1) % phrases.length;
          setTimeout(typewrite, pauseStart);
          return;
        }
        setTimeout(typewrite, deleteSpeed);
      }
    }

    setTimeout(typewrite, 800);
  }
})();
</script>
